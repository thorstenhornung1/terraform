version: '3.8'

# Docker Swarm Dashboard (heckenmann/docker-swarm-dashboard)
# Deploy with: docker stack deploy -c docker-swarm-dashboard-stack.yml dashboard
# Access UI at: http://<any-swarm-node>:8080

services:
  docker-swarm-dashboard:
    image: ghcr.io/heckenmann/docker-swarm-dashboard:1.8.3
    environment:
      # Docker v29 requires minimum API 1.44
      - DOCKER_API_VERSION=1.44
      - DSD_HTTP_PORT=8080
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro
    ports:
      - "8080:8080"
    networks:
      - dashboard-net
    deploy:
      replicas: 1
      placement:
        constraints:
          - node.role == manager
      resources:
        limits:
          cpus: '0.5'
          memory: 256M
        reservations:
          cpus: '0.1'
          memory: 64M
      restart_policy:
        condition: on-failure
        delay: 5s
        max_attempts: 3

networks:
  dashboard-net:
    driver: overlay
    attachable: true
